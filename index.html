<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Zone Converter</title>
</head>
<body>
    <div id="CalculatorContainer"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Create the calculator container
            const calculatorContainer = document.getElementById('CalculatorContainer');
            
            // Generate CSS styles
            const style = document.createElement('style');
            style.textContent = `
                #CalculatorContainer * {
                    box-sizing: border-box;
                    margin: 0;
                    padding: 0;
                    font-family: 'Georgia', serif;
                }
                
                #CalculatorContainer {
                    background-color: #f4f2eb;
                    color: #333;
                    min-height: 100vh;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    padding: 20px;
                }
                
                #CalculatorContainer .header {
                    text-align: center;
                    margin-bottom: 25px;
                    width: 100%;
                }
                
                #CalculatorContainer .header h2 {
                    color: #ad2a24;
                    font-size: 2.0rem;
                    margin-bottom: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                }
                
                #CalculatorContainer .header p {
                    color: #666;
                    font-size: 1.1rem;
                    max-width: 600px;
                    margin: 0 auto;
                }

                #CalculatorContainer .container {
                    background-color: #f9f5e8;
                    border-radius: 10px;
                    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                    width: 100%;
                    max-width: 650px;
                    padding: 25px;
                    margin-bottom: 30px;
                }
                
                #CalculatorContainer .card {
                    margin-bottom: 20px;
                    padding: 20px;
                    border-radius: 8px;
                    background: #fdfdfd;
                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                }
                
                #CalculatorContainer .card-title {
                    display: flex;
                    align-items: center;
                    margin-bottom: 15px;
                    color: #ad2a24;
                    gap: 10px;
                }
                
                #CalculatorContainer .card-title svg {
                    width: 20px;
                    height: 20px;
                    fill: #ad2a24;
                }
                
                #CalculatorContainer .input-group {
                    margin-bottom: 15px;
                    position: relative;
                }
                
                #CalculatorContainer label {
                    display: block;
                    margin-bottom: 8px;
                    font-weight: 600;
                    color: #555;
                }
                
                #CalculatorContainer input, 
                #CalculatorContainer select {
                    width: 100%;
                    padding: 12px 15px;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    font-size: 16px;
                    transition: border-color 0.3s;
                }
                
                #CalculatorContainer input:focus, 
                #CalculatorContainer select:focus {
                    border-color: #ad2a24;
                    outline: none;
                    box-shadow: 0 0 0 2px rgba(173, 42, 36, 0.2);
                }
                
                /* Searchable dropdown styles */
                #CalculatorContainer .search-container {
                    position: relative;
                }
                
                #CalculatorContainer .search-input-container {
                    display: flex;
                    gap: 10px;
                }
                
                #CalculatorContainer .search-input {
                    flex: 1;
                    padding-left: 35px;
                }
                
                #CalculatorContainer .search-icon {
                    position: absolute;
                    left: 12px;
                    top: 50%;
                    transform: translateY(-50%);
                    color: #777;
                    pointer-events: none;
                }
                
                #CalculatorContainer .search-btn {
                    background-color: #ad2a24;
                    color: white;
                    border: none;
                    padding: 12px 15px;
                    border-radius: 6px;
                    font-size: 16px;
                    cursor: pointer;
                    transition: background-color 0.3s;
                }
                
                #CalculatorContainer .search-btn:hover {
                    background-color: #93211c;
                }
                
                #CalculatorContainer .dropdown-container {
                    position: relative;
                }
                
                #CalculatorContainer .timezone-dropdown {
                    display: none;
                    position: absolute;
                    top: 100%;
                    left: 0;
                    width: 100%;
                    max-height: 300px;
                    overflow-y: auto;
                    background: white;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                    z-index: 100;
                }
                
                #CalculatorContainer .timezone-dropdown.visible {
                    display: block;
                    animation: fadeIn 0.3s ease-in-out;
                }
                
                #CalculatorContainer .timezone-option {
                    padding: 10px 15px;
                    cursor: pointer;
                    display: flex;
                    justify-content: space-between;
                    border-bottom: 1px solid #f0f0f0;
                }
                
                #CalculatorContainer .timezone-option:hover {
                    background-color: #f9f5e8;
                }
                
                #CalculatorContainer .timezone-city {
                    flex: 2;
                }
                
                #CalculatorContainer .timezone-offset {
                    flex: 1;
                    text-align: right;
                    color: #777;
                }
                
                #CalculatorContainer .timezone-group {
                    font-weight: 600;
                    background-color: #f5f5f5;
                    padding: 8px 12px;
                    color: #ad2a24;
                    position: sticky;
                    top: 0;
                    z-index: 10;
                }
                
                #CalculatorContainer .selected-timezone {
                    margin-top: 10px;
                    padding: 10px;
                    background-color: #f9f9f9;
                    border-radius: 6px;
                    border: 1px solid #eee;
                }
                
                #CalculatorContainer .btn-container {
                    display: flex;
                    justify-content: center;
                    margin: 25px 0;
                }
                
                #CalculatorContainer button {
                    background-color: #ad2a24;
                    color: white;
                    border: none;
                    padding: 14px 30px;
                    border-radius: 6px;
                    font-size: 16px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: background-color 0.3s, transform 0.2s;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }
                
                #CalculatorContainer button:hover {
                    background-color: #93211c;
                    transform: translateY(-2px);
                }
                
                #CalculatorContainer button:active {
                    transform: translateY(0);
                }
                
                #CalculatorContainer .result {
                    margin-top: 20px;
                    padding: 25px;
                    background-color: #fff;
                    border-radius: 8px;
                    text-align: center;
                    min-height: 150px;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    display: none;
                }
                
                #CalculatorContainer .result.visible {
                    display: flex;
                    animation: fadeIn 0.5s ease-in-out;
                }
                
                #CalculatorContainer .result h3 {
                    margin-bottom: 15px;
                    color: #555;
                    font-size: 1.0rem;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 8px;
                }
                
                #CalculatorContainer .converted-time {
                    font-size: 1.5rem;
                    font-weight: bold;
                    color: #ad2a24;
                    margin: 10px 0;
                }
                
                #CalculatorContainer .time-details {
                    margin-top: 15px;
                    font-size: 0.95rem;
                    color: #666;
                    line-height: 1.6;
                }
                
                #CalculatorContainer .footer {
                    margin-top: 20px;
                    color: #777;
                    text-align: center;
                    font-size: 0.9rem;
                    width: 100%;
                }
                
                /* Autocomplete styles */
                #CalculatorContainer .autocomplete-container {
                    position: relative;
                }
                
                #CalculatorContainer .autocomplete-dropdown {
                    display: none;
                    position: absolute;
                    top: 100%;
                    left: 0;
                    width: 100%;
                    max-height: 200px;
                    overflow-y: auto;
                    background: white;
                    border: 1px solid #ddd;
                    border-radius: 0 0 6px 6px;
                    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                    z-index: 101;
                }
                
                #CalculatorContainer .autocomplete-dropdown.visible {
                    display: block;
                }
                
                #CalculatorContainer .autocomplete-option {
                    padding: 10px 15px;
                    cursor: pointer;
                    border-bottom: 1px solid #f0f0f0;
                }
                
                #CalculatorContainer .autocomplete-option:hover {
                    background-color: #f9f5e8;
                }
                
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(10px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                
                @media (max-width: 600px) {
                    #CalculatorContainer .container {
                        padding: 15px;
                    }
                    
                    #CalculatorContainer .header h2 {
                        font-size: 1.8rem;
                    }
                    
                    #CalculatorContainer .converted-time {
                        font-size: 1.4rem;
                    }
                    
                    #CalculatorContainer button {
                        width: 100%;
                        justify-content: center;
                    }
                    
                    #CalculatorContainer input, 
                    #CalculatorContainer select {
                        padding: 14px 12px;
                        font-size: 16px;
                    }
                    
                    #CalculatorContainer .timezone-option {
                        flex-direction: column;
                    }
                    
                    #CalculatorContainer .timezone-offset {
                        text-align: left;
                        margin-top: 4px;
                        font-size: 0.9em;
                    }
                    
                    #CalculatorContainer .search-input-container {
                        flex-direction: column;
                    }
                    
                    #CalculatorContainer .search-btn {
                        width: 100%;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // Generate HTML structure
            calculatorContainer.innerHTML = `
                <div class="container">
                    <div class="header">
                        <h2>Time Zone Converter</h2>
                        <p>Convert between time zones with automatic Daylight Saving Time handling</p>
                    </div>
                    <div class="card">
                        <div class="card-title">
                            <h2>Date & Time</h2>
                        </div>
                        <div class="input-group">
                            <label for="datetime">Select Date and Time</label>
                            <input type="datetime-local" id="datetime">
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">
                            <h2>Time Zones</h2>
                        </div>
                        <div class="input-group">
                            <label for="source-timezone">From Timezone</label>
                            <div class="autocomplete-container">
                                <div class="search-input-container">
                                    <div class="search-container" style="flex: 1;">
                                        <span class="search-icon">🔍</span>
                                        <input type="text" id="source-search" class="search-input" placeholder="Type or search for a city">
                                    </div>
                                    <button class="search-btn" id="source-search-btn">Search</button>
                                </div>
                                <div id="source-autocomplete" class="autocomplete-dropdown"></div>
                                <div id="source-dropdown" class="timezone-dropdown"></div>
                                <div id="source-selected" class="selected-timezone">No timezone selected</div>
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label for="target-timezone">To Timezone</label>
                            <div class="autocomplete-container">
                                <div class="search-input-container">
                                    <div class="search-container" style="flex: 1;">
                                        <span class="search-icon">🔍</span>
                                        <input type="text" id="target-search" class="search-input" placeholder="Type or search for a city">
                                    </div>
                                    <button class="search-btn" id="target-search-btn">Search</button>
                                </div>
                                <div id="target-autocomplete" class="autocomplete-dropdown"></div>
                                <div id="target-dropdown" class="timezone-dropdown"></div>
                                <div id="target-selected" class="selected-timezone">No timezone selected</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-container">
                        <button id="convert-btn">Convert Timezone</button>
                    </div>
                    
                    <div class="result" id="result-section">
                        <h3>Converted Date & Time</h3>
                        <div id="output" class="converted-time"></div>
                        <div id="time-details" class="time-details"></div>
                    </div>
                </div>
            `;
            
            // Set default timezones to New York and London
            const defaultSourceTimezone = "America/New_York";
            const defaultTargetTimezone = "Europe/London";
            
            // Get elements
            const sourceSearchBtn = document.getElementById('source-search-btn');
            const targetSearchBtn = document.getElementById('target-search-btn');
            const sourceSearchInput = document.getElementById('source-search');
            const targetSearchInput = document.getElementById('target-search');
            const sourceDropdown = document.getElementById('source-dropdown');
            const targetDropdown = document.getElementById('target-dropdown');
            const sourceAutocomplete = document.getElementById('source-autocomplete');
            const targetAutocomplete = document.getElementById('target-autocomplete');
            const sourceSelected = document.getElementById('source-selected');
            const targetSelected = document.getElementById('target-selected');
            const resultSection = document.getElementById('result-section');
            
            // Store selected timezones
            let selectedSourceTimezone = defaultSourceTimezone;
            let selectedTargetTimezone = defaultTargetTimezone;
            
            // Major cities with their timezones and display names
            const majorCities = [
                { name: "New York", timezone: "America/New_York", country: "United States", group: "United States" },
                { name: "Los Angeles", timezone: "America/Los_Angeles", country: "United States", group: "United States" },
                { name: "Chicago", timezone: "America/Chicago", country: "United States", group: "United States" },
                { name: "Denver", timezone: "America/Denver", country: "United States", group: "United States" },
                { name: "Phoenix", timezone: "America/Phoenix", country: "United States", group: "United States" },
                { name: "Toronto", timezone: "America/Toronto", country: "Canada", group: "Canada" },
                { name: "Vancouver", timezone: "America/Vancouver", country: "Canada", group: "Canada" },
                { name: "London", timezone: "Europe/London", country: "United Kingdom", group: "Europe" },
                { name: "Paris", timezone: "Europe/Paris", country: "France", group: "Europe" },
                { name: "Berlin", timezone: "Europe/Berlin", country: "Germany", group: "Europe" },
                { name: "Madrid", timezone: "Europe/Madrid", country: "Spain", group: "Europe" },
                { name: "Rome", timezone: "Europe/Rome", country: "Italy", group: "Europe" },
                { name: "Amsterdam", timezone: "Europe/Amsterdam", country: "Netherlands", group: "Europe" },
                { name: "Brussels", timezone: "Europe/Brussels", country: "Belgium", group: "Europe" },
                { name: "Vienna", timezone: "Europe/Vienna", country: "Austria", group: "Europe" },
                { name: "Zurich", timezone: "Europe/Zurich", country: "Switzerland", group: "Europe" },
                { name: "Stockholm", timezone: "Europe/Stockholm", country: "Sweden", group: "Europe" },
                { name: "Oslo", timezone: "Europe/Oslo", country: "Norway", group: "Europe" },
                { name: "Copenhagen", timezone: "Europe/Copenhagen", country: "Denmark", group: "Europe" },
                { name: "Athens", timezone: "Europe/Athens", country: "Greece", group: "Europe" },
                { name: "Prague", timezone: "Europe/Prague", country: "Czech Republic", group: "Europe" },
                { name: "Warsaw", timezone: "Europe/Warsaw", country: "Poland", group: "Europe" },
                { name: "Budapest", timezone: "Europe/Budapest", country: "Hungary", group: "Europe" },
                { name: "Dublin", timezone: "Europe/Dublin", country: "Ireland", group: "Europe" },
                { name: "Lisbon", timezone: "Europe/Lisbon", country: "Portugal", group: "Europe" },
                { name: "Istanbul", timezone: "Europe/Istanbul", country: "Turkey", group: "Europe" },
                { name: "Moscow", timezone: "Europe/Moscow", country: "Russia", group: "Europe" },
                { name: "Dubai", timezone: "Asia/Dubai", country: "United Arab Emirates", group: "Middle East" },
                { name: "Riyadh", timezone: "Asia/Riyadh", country: "Saudi Arabia", group: "Middle East" },
                { name: "Tel Aviv", timezone: "Asia/Jerusalem", country: "Israel", group: "Middle East" },
                { name: "Tokyo", timezone: "Asia/Tokyo", country: "Japan", group: "Asia" },
                { name: "Seoul", timezone: "Asia/Seoul", country: "South Korea", group: "Asia" },
                { name: "Shanghai", timezone: "Asia/Shanghai", country: "China", group: "Asia" },
                { name: "Beijing", timezone: "Asia/Shanghai", country: "China", group: "Asia" },
                { name: "Hong Kong", timezone: "Asia/Hong_Kong", country: "Hong Kong", group: "Asia" },
                { name: "Singapore", timezone: "Asia/Singapore", country: "Singapore", group: "Asia" },
                { name: "Kuala Lumpur", timezone: "Asia/Kuala_Lumpur", country: "Malaysia", group: "Asia" },
                { name: "Bangkok", timezone: "Asia/Bangkok", country: "Thailand", group: "Asia" },
                { name: "Jakarta", timezone: "Asia/Jakarta", country: "Indonesia", group: "Asia" },
                { name: "Manila", timezone: "Asia/Manila", country: "Philippines", group: "Asia" },
                { name: "Mumbai", timezone: "Asia/Kolkata", country: "India", group: "Asia" },
                { name: "Delhi", timezone: "Asia/Kolkata", country: "India", group: "Asia" },
                { name: "Sydney", timezone: "Australia/Sydney", country: "Australia", group: "Australia & Oceania" },
                { name: "Melbourne", timezone: "Australia/Melbourne", country: "Australia", group: "Australia & Oceania" },
                { name: "Brisbane", timezone: "Australia/Brisbane", country: "Australia", group: "Australia & Oceania" },
                { name: "Perth", timezone: "Australia/Perth", country: "Australia", group: "Australia & Oceania" },
                { name: "Auckland", timezone: "Pacific/Auckland", country: "New Zealand", group: "Australia & Oceania" },
                { name: "Wellington", timezone: "Pacific/Auckland", country: "New Zealand", group: "Australia & Oceania" },
                { name: "Mexico City", timezone: "America/Mexico_City", country: "Mexico", group: "Latin America" },
                { name: "Sao Paulo", timezone: "America/Sao_Paulo", country: "Brazil", group: "Latin America" },
                { name: "Rio de Janeiro", timezone: "America/Sao_Paulo", country: "Brazil", group: "Latin America" },
                { name: "Buenos Aires", timezone: "America/Argentina/Buenos_Aires", country: "Argentina", group: "Latin America" },
                { name: "Lima", timezone: "America/Lima", country: "Peru", group: "Latin America" },
                { name: "Bogota", timezone: "America/Bogota", country: "Colombia", group: "Latin America" },
                { name: "Santiago", timezone: "America/Santiago", country: "Chile", group: "Latin America" },
                { name: "Caracas", timezone: "America/Caracas", country: "Venezuela", group: "Latin America" },
                { name: "Johannesburg", timezone: "Africa/Johannesburg", country: "South Africa", group: "Africa" },
                { name: "Cairo", timezone: "Africa/Cairo", country: "Egypt", group: "Africa" },
                { name: "Nairobi", timezone: "Africa/Nairobi", country: "Kenya", group: "Africa" },
                { name: "Lagos", timezone: "Africa/Lagos", country: "Nigeria", group: "Africa" },
                { name: "Casablanca", timezone: "Africa/Casablanca", country: "Morocco", group: "Africa" },
                { name: "Honolulu", timezone: "Pacific/Honolulu", country: "United States", group: "United States" },
                { name: "Anchorage", timezone: "America/Anchorage", country: "United States", group: "United States" }
            ];
            
            // Group cities by their group property
            const groupedCities = {};
            majorCities.forEach(city => {
                if (!groupedCities[city.group]) {
                    groupedCities[city.group] = [];
                }
                groupedCities[city.group].push(city);
            });
            
            // Sort groups alphabetically
            const sortedGroups = Object.keys(groupedCities).sort();
            
            // Function to format UTC offset
            function formatUTCOffset(date, timezone) {
                try {
                    const formatter = new Intl.DateTimeFormat('en-US', {
                        timeZone: timezone,
                        timeZoneName: 'shortOffset'
                    });
                    
                    const parts = formatter.formatToParts(date);
                    const offsetPart = parts.find(part => part.type === 'timeZoneName');
                    
                    if (offsetPart) {
                        return offsetPart.value.replace('GMT', 'UTC');
                    }
                    
                    // Fallback method if the above doesn't work
                    const offsetMs = new Date(date).getTimezoneOffset() * 60000;
                    const timezoneOffsetMs = new Date(date.toLocaleString('en-US', { timeZone: timezone })).getTimezoneOffset() * 60000;
                    const diffMs = offsetMs - timezoneOffsetMs;
                    const diffHours = Math.floor(Math.abs(diffMs) / 3600000);
                    const diffMinutes = Math.floor((Math.abs(diffMs) % 3600000) / 60000);
                    const sign = diffMs > 0 ? '+' : '-';
                    
                    return `UTC ${sign}${String(diffHours).padStart(2, '0')}:${String(diffMinutes).padStart(2, '0')}`;
                } catch (e) {
                    return 'UTC';
                }
            }
            
            // Function to populate timezone dropdown
            function populateTimezoneDropdown(dropdownElement, searchInput, isSource) {
                // Clear existing options
                dropdownElement.innerHTML = '';
                
                const now = new Date();
                const filter = searchInput.value.toLowerCase();
                
                // Add grouped cities
                sortedGroups.forEach(group => {
                    let groupHasVisibleOptions = false;
                    
                    // Check if group has matching options
                    for (const city of groupedCities[group]) {
                        const displayText = `${city.name}, ${city.country}`.toLowerCase();
                        if (displayText.includes(filter)) {
                            groupHasVisibleOptions = true;
                            break;
                        }
                    }
                    
                    if (!groupHasVisibleOptions) return;
                    
                    // Add group header
                    const groupHeader = document.createElement('div');
                    groupHeader.className = 'timezone-group';
                    groupHeader.textContent = group;
                    dropdownElement.appendChild(groupHeader);
                    
                    // Add cities in this group
                    groupedCities[group].forEach(city => {
                        const displayText = `${city.name}, ${city.country}`.toLowerCase();
                        if (!displayText.includes(filter)) return;
                        
                        const offset = formatUTCOffset(now, city.timezone);
                        
                        const option = document.createElement('div');
                        option.className = 'timezone-option';
                        option.dataset.timezone = city.timezone;
                        option.dataset.display = `${city.name}, ${city.country}`;
                        
                        const citySpan = document.createElement('span');
                        citySpan.className = 'timezone-city';
                        citySpan.textContent = `${city.name}, ${city.country}`;
                        
                        const offsetSpan = document.createElement('span');
                        offsetSpan.className = 'timezone-offset';
                        offsetSpan.textContent = offset;
                        
                        option.appendChild(citySpan);
                        option.appendChild(offsetSpan);
                        
                        option.addEventListener('click', () => {
                            if (isSource) {
                                selectedSourceTimezone = city.timezone;
                                sourceSelected.textContent = `${city.name}, ${city.country} (${offset})`;
                                sourceSearchInput.value = '';
                            } else {
                                selectedTargetTimezone = city.timezone;
                                targetSelected.textContent = `${city.name}, ${city.country} (${offset})`;
                                targetSearchInput.value = '';
                            }
                            dropdownElement.classList.remove('visible');
                            hideAutocomplete(isSource);
                        });
                        
                        dropdownElement.appendChild(option);
                    });
                });
            }
            
            // Function to show autocomplete suggestions
            function showAutocompleteSuggestions(inputElement, autocompleteElement, isSource) {
                const query = inputElement.value.toLowerCase();
                if (query.length < 2) {
                    autocompleteElement.classList.remove('visible');
                    return;
                }
                
                autocompleteElement.innerHTML = '';
                
                // Filter cities based on query
                const suggestions = majorCities.filter(city => 
                    `${city.name}, ${city.country}`.toLowerCase().includes(query)
                ).slice(0, 5); // Limit to 5 suggestions
                
                if (suggestions.length === 0) {
                    autocompleteElement.classList.remove('visible');
                    return;
                }
                
                suggestions.forEach(city => {
                    const option = document.createElement('div');
                    option.className = 'autocomplete-option';
                    option.textContent = `${city.name}, ${city.country}`;
                    option.addEventListener('click', () => {
                        const now = new Date();
                        const offset = formatUTCOffset(now, city.timezone);
                        
                        if (isSource) {
                            selectedSourceTimezone = city.timezone;
                            sourceSelected.textContent = `${city.name}, ${city.country} (${offset})`;
                            sourceSearchInput.value = '';
                        } else {
                            selectedTargetTimezone = city.timezone;
                            targetSelected.textContent = `${city.name}, ${city.country} (${offset})`;
                            targetSearchInput.value = '';
                        }
                        
                        autocompleteElement.classList.remove('visible');
                    });
                    
                    autocompleteElement.appendChild(option);
                });
                
                autocompleteElement.classList.add('visible');
            }
            
            // Function to hide autocomplete
            function hideAutocomplete(isSource) {
                if (isSource) {
                    sourceAutocomplete.classList.remove('visible');
                } else {
                    targetAutocomplete.classList.remove('visible');
                }
            }
            
            // Set initial selected timezones
            function setInitialSelected() {
                const now = new Date();
                
                // Find New York and London in the majorCities array
                const newYorkCity = majorCities.find(city => city.timezone === defaultSourceTimezone);
                const londonCity = majorCities.find(city => city.timezone === defaultTargetTimezone);
                
                const sourceOffset = formatUTCOffset(now, defaultSourceTimezone);
                const targetOffset = formatUTCOffset(now, defaultTargetTimezone);
                
                // Set the display text for the selected timezones
                sourceSelected.textContent = `${newYorkCity.name}, ${newYorkCity.country} (${sourceOffset})`;
                targetSelected.textContent = `${londonCity.name}, ${londonCity.country} (${targetOffset})`;
                
                // Clear input values, keep only placeholder
                sourceSearchInput.value = '';
                targetSearchInput.value = '';
            }
            
            // Set up event listeners
            sourceSearchBtn.addEventListener('click', () => {
                // Show all options when search button is clicked
                sourceSearchInput.value = '';
                sourceDropdown.classList.toggle('visible');
                if (sourceDropdown.classList.contains('visible')) {
                    populateTimezoneDropdown(sourceDropdown, sourceSearchInput, true);
                    sourceSearchInput.focus();
                }
            });
            
            targetSearchBtn.addEventListener('click', () => {
                // Show all options when search button is clicked
                targetSearchInput.value = '';
                targetDropdown.classList.toggle('visible');
                if (targetDropdown.classList.contains('visible')) {
                    populateTimezoneDropdown(targetDropdown, targetSearchInput, false);
                    targetSearchInput.focus();
                }
            });
            
            // Autocomplete functionality
            sourceSearchInput.addEventListener('input', () => {
                showAutocompleteSuggestions(sourceSearchInput, sourceAutocomplete, true);
            });
            
            targetSearchInput.addEventListener('input', () => {
                showAutocompleteSuggestions(targetSearchInput, targetAutocomplete, false);
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', (e) => {
                if (!sourceSearchBtn.contains(e.target) && !sourceDropdown.contains(e.target) && 
                    !sourceSearchInput.contains(e.target) && !sourceAutocomplete.contains(e.target)) {
                    sourceDropdown.classList.remove('visible');
                    hideAutocomplete(true);
                }
                if (!targetSearchBtn.contains(e.target) && !targetDropdown.contains(e.target) && 
                    !targetSearchInput.contains(e.target) && !targetAutocomplete.contains(e.target)) {
                    targetDropdown.classList.remove('visible');
                    hideAutocomplete(false);
                }
            });
            
            // Set current datetime as default
            const now = new Date();
            const localDatetime = new Date(now.getTime() - now.getTimezoneOffset() * 60000).toISOString().slice(0, 16);
            document.getElementById('datetime').value = localDatetime;
            
            // Set initial selected timezones
            setInitialSelected();
            
            // Add event listener to convert button
            document.getElementById('convert-btn').addEventListener('click', convertTimezone);
            
            // Function to convert timezone
            function convertTimezone() {
                const datetimeInput = document.getElementById('datetime').value;
                
                if (!datetimeInput) {
                    alert('Please select a date and time');
                    return;
                }
                
                // Parse the input datetime (in local time) and convert to source timezone
                const localDate = new Date(datetimeInput);
                
                // Format the date in source timezone for display
                const sourceFormatter = new Intl.DateTimeFormat('en-US', {
                    timeZone: selectedSourceTimezone,
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: 'numeric',
                    minute: 'numeric',
                    timeZoneName: 'short'
                });
                
                // Format the date in target timezone
                const targetFormatter = new Intl.DateTimeFormat('en-US', {
                    timeZone: selectedTargetTimezone,
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: 'numeric',
                    minute: 'numeric',
                    timeZoneName: 'short'
                });
                
                // Get the offset details
                const sourceOffset = formatUTCOffset(localDate, selectedSourceTimezone);
                const targetOffset = formatUTCOffset(localDate, selectedTargetTimezone);
                
                try {
                    const sourceTimeStr = sourceFormatter.format(localDate);
                    const targetTimeStr = targetFormatter.format(localDate);
                    
                    // Find city names for display
                    const sourceCity = majorCities.find(city => city.timezone === selectedSourceTimezone) || 
                                      { name: selectedSourceTimezone.split('/').pop(), country: '' };
                    const targetCity = majorCities.find(city => city.timezone === selectedTargetTimezone) || 
                                      { name: selectedTargetTimezone.split('/').pop(), country: '' };
                    
                    document.getElementById('output').textContent = targetTimeStr;
                    document.getElementById('time-details').innerHTML = `
                        <strong>Source time:</strong> ${sourceTimeStr} (${sourceOffset})<br>
                        <strong>Target timezone:</strong> ${targetCity.name}, ${targetCity.country} (${targetOffset})
                    `;
                    
                    // Show the result section
                    resultSection.classList.add('visible');
                } catch (e) {
                    document.getElementById('output').textContent = 'Error: Invalid timezone conversion';
                    console.error(e);
                }
            }
        });
    </script>
</body>
</html>